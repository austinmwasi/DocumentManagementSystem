"use strict";(self.webpackChunkdocument_management=self.webpackChunkdocument_management||[]).push([[578],{4913:(y,T,i)=>{i.d(T,{J:()=>f});var l=i(5519);class f extends l.r{constructor(){super(...arguments),this.id="",this.createdBy="",this.categoryId=""}}},2760:(y,T,i)=>{i.d(T,{c:()=>f});const f=[{id:0,name:"Daily"},{id:1,name:"Weekly"},{id:2,name:"Monthly"},{id:3,name:"Quarterly"},{id:4,name:"HalfYearly"},{id:5,name:"Yearly"}]},6943:(y,T,i)=>{i.d(T,{H:()=>A});var l=i(5e3),f=i(520);let A=(()=>{class d{constructor(c){this.httpClient=c}getAllCategories(){return this.httpClient.get("Category")}delete(c){return this.httpClient.delete(`Category/${c}`)}update(c){return this.httpClient.put(`Category/${c.id}`,c)}add(c){return this.httpClient.post("Category",c)}getSubCategories(c){return this.httpClient.get(`Category/${c}/subcategories`)}getAllCategoriesForDropDown(){return this.httpClient.get("Category/dropdown")}}return d.\u0275fac=function(c){return new(c||d)(l.LFG(f.eN))},d.\u0275prov=l.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"}),d})()},690:(y,T,i)=>{i.d(T,{v:()=>h});var l=i(520),f=i(1086),A=i(7221),d=i(2760),C=i(5e3),c=i(8032);let h=(()=>{class D{constructor(o,s){this.httpClient=o,this.commonHttpErrorService=s}getUsers(){return this.httpClient.get("user").pipe((0,A.K)(this.commonHttpErrorService.handleError))}getRoles(){return this.httpClient.get("role").pipe((0,A.K)(this.commonHttpErrorService.handleError))}getReminder(o){return this.httpClient.get(`reminder/${o}`).pipe((0,A.K)(this.commonHttpErrorService.handleError))}addDocumentAuditTrail(o){return this.httpClient.post("documentAuditTrail",o)}downloadDocument(o,s){return this.httpClient.get(`document/${o}/download?isVersion=${s}`,{reportProgress:!0,observe:"events",responseType:"blob"})}isDownloadFlag(o,s){return this.httpClient.get(`document/${o}/isDownloadFlag?isPermission=${s}`)}getDocumentToken(o){return this.httpClient.get(`documentToken/${o}/token`)}deleteDocumentToken(o){return this.httpClient.delete(`documentToken/${o}`)}readDocument(o,s){return this.httpClient.get(`document/${o}/readText?isVersion=${s}`)}getReminderFrequency(){return(0,f.of)(d.c)}addDocumentWithAssign(o){var s;o.documentMetaDatas=null===(s=o.documentMetaDatas)||void 0===s?void 0:s.filter(_=>_.metatag);const v=new FormData;return v.append("files",o.files),v.append("name",o.name),v.append("categoryId",o.categoryId),v.append("description",o.description),v.append("documentMetaDataString",JSON.stringify(o.documentMetaDatas)),this.httpClient.post("document/assign",v).pipe((0,A.K)(this.commonHttpErrorService.handleError))}getAllRemindersForCurrentUser(o){const g=(new l.LE).set("Fields",o.fields?o.fields:"").set("OrderBy",o.orderBy?o.orderBy:"").set("PageSize",o.pageSize.toString()).set("Skip",o.skip.toString()).set("SearchQuery",o.searchQuery?o.searchQuery:"").set("subject",o.subject?o.subject:"").set("message",o.message?o.message:"").set("frequency",o.frequency?o.frequency:"");return this.httpClient.get("reminder/all/currentuser",{params:g,observe:"response"})}deleteReminderCurrentUser(o){return this.httpClient.delete(`reminder/${o}/currentuser`)}}return D.\u0275fac=function(o){return new(o||D)(C.LFG(l.eN),C.LFG(c.U))},D.\u0275prov=C.Yz7({token:D,factory:D.\u0275fac,providedIn:"root"}),D})()},8578:(y,T,i)=>{i.r(T),i.d(T,{DocumentAuditTrailModule:()=>mt});var l=i(9808),f=i(2784),A=i(319),d=i(6087),C=i(4847),c=i(4913),h=i(6787),D=i(3753),S=i(2868),o=i(13),s=i(5778),g=i(2676),v=i(591),_=i(1086),Z=i(7221),N=i(537);class O{constructor(a){this.documentAuditTrailService=a,this.documentAuditTrailsSubject=new v.X([]),this.responseHeaderSubject=new v.X(null),this.loadingSubject=new v.X(!1),this.loading$=this.loadingSubject.asObservable(),this._count=0,this.responseHeaderSubject$=this.responseHeaderSubject.asObservable()}get count(){return this._count}connect(a){return this.documentAuditTrailsSubject.asObservable()}disconnect(a){this.documentAuditTrailsSubject.complete(),this.loadingSubject.complete()}loadDocumentAuditTrails(a){this.loadingSubject.next(!0),this.documentAuditTrailService.getDocumentAuditTrials(a).pipe((0,Z.K)(()=>(0,_.of)([])),(0,N.x)(()=>this.loadingSubject.next(!1))).subscribe(n=>{const r=JSON.parse(n.headers.get("X-Pagination"));this.responseHeaderSubject.next(r);const u=[...n.body];this._count=u.length,this.documentAuditTrailsSubject.next(u)})}}var t=i(5e3),E=i(520),L=i(8032);let M=(()=>{class e{constructor(n,r){this.httpClient=n,this.commonHttpErrorService=r}getDocumentAuditTrials(n){const u=(new E.LE).set("Fields",n.fields).set("OrderBy",n.orderBy).set("PageSize",n.pageSize.toString()).set("Skip",n.skip.toString()).set("SearchQuery",n.searchQuery).set("categoryId",n.categoryId).set("name",n.name).set("id",n.id.toString()).set("createdBy",n.createdBy.toString());return this.httpClient.get("documentAuditTrail",{params:u,observe:"response"}).pipe((0,Z.K)(this.commonHttpErrorService.handleError))}}return e.\u0275fac=function(n){return new(n||e)(t.LFG(E.eN),t.LFG(L.U))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var j=i(6943),B=i(690),m=i(2075),R=i(773),x=i(4107),I=i(508),U=i(2925);const Y=["input"];function $(e,a){1&e&&(t.TgZ(0,"div",27),t._UZ(1,"mat-spinner"),t.qZA())}function b(e,a){if(1&e&&(t.TgZ(0,"div")(1,"b"),t._uU(2),t.qZA()()),2&e){const n=t.oxw().$implicit;t.xp6(2),t.hij(" ",n.name,"")}}function H(e,a){if(1&e&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&e){const n=t.oxw().$implicit;t.xp6(1),t.hij(" ",n.name," ")}}const Q=function(e){return{"margin-left.px":e}};function F(e,a){if(1&e&&(t.TgZ(0,"mat-option",11)(1,"div",28),t.YNc(2,b,3,1,"div",29),t.YNc(3,H,2,1,"div",29),t.qZA()()),2&e){const n=a.$implicit;t.Q6J("value",n.id),t.xp6(1),t.Q6J("ngStyle",t.VKq(4,Q,20*n.deafLevel)),t.xp6(1),t.Q6J("ngIf",!n.parentId),t.xp6(1),t.Q6J("ngIf",n.parentId)}}function z(e,a){if(1&e&&(t.TgZ(0,"mat-option",11),t._uU(1),t.qZA()),2&e){const n=a.$implicit;t.Q6J("value",n.id),t.xp6(1),t.AsE(" ",n.firstName," ",n.lastName," ")}}function J(e,a){1&e&&(t.TgZ(0,"th",30),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"NAME")," "))}function P(e,a){if(1&e&&(t.TgZ(0,"td",31),t._uU(1),t.qZA()),2&e){const n=a.$implicit;t.xp6(1),t.hij(" ",n.documentName," ")}}function K(e,a){1&e&&(t.TgZ(0,"th",30),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"CATEGORY_NAME")," "))}function W(e,a){if(1&e&&(t.TgZ(0,"td",31),t._uU(1),t.qZA()),2&e){const n=a.$implicit;t.xp6(1),t.hij(" ",n.categoryName," ")}}function w(e,a){1&e&&(t.TgZ(0,"th",30),t._uU(1),t.ALo(2,"translate"),t.ALo(3,"translate"),t.qZA()),2&e&&(t.xp6(1),t.AsE(" ",t.lcZ(2,2,"ACTION")," ",t.lcZ(3,4,"DATE"),""))}function G(e,a){if(1&e&&(t.TgZ(0,"td",31),t._uU(1),t.ALo(2,"date"),t.qZA()),2&e){const n=a.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,null==n?null:n.createdDate,"dd/MM/yyyy hh:mm:ss a")," ")}}function X(e,a){1&e&&(t.TgZ(0,"th",30),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"OPERATION")," "))}function V(e,a){if(1&e&&(t.TgZ(0,"td",31),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e){const n=a.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,n.operationName.toUpperCase())," ")}}function k(e,a){1&e&&(t.TgZ(0,"th",30),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"BY_WHOM")," "))}function q(e,a){if(1&e&&(t.TgZ(0,"td",31),t._uU(1),t.qZA()),2&e){const n=a.$implicit;t.xp6(1),t.hij(" ",null==n?null:n.createdBy," ")}}function tt(e,a){1&e&&(t.TgZ(0,"th",30),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"TO_WHOM_USER")," "))}function et(e,a){if(1&e&&(t.TgZ(0,"td",31),t._uU(1),t.qZA()),2&e){const n=a.$implicit;t.xp6(1),t.hij(" ",null==n?null:n.permissionUser," ")}}function nt(e,a){1&e&&(t.TgZ(0,"th",30),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"TO_WHOM_ROLE")," "))}function ot(e,a){if(1&e&&(t.TgZ(0,"td",31),t._uU(1),t.qZA()),2&e){const n=a.$implicit;t.xp6(1),t.hij(" ",null==n?null:n.permissionRole," ")}}function it(e,a){1&e&&t._UZ(0,"tr",32)}function at(e,a){1&e&&t._UZ(0,"tr",33)}function rt(e,a){1&e&&(t.TgZ(0,"tr")(1,"td")(2,"div",34)(3,"b"),t._uU(4),t.ALo(5,"translate"),t.qZA()()()()),2&e&&(t.xp6(4),t.hij(" ",t.lcZ(5,1,"NO_DATA_FOUND"),""))}const st=function(){return[10,20,30]},ct=[{path:"",component:(()=>{class e extends g.H{constructor(n,r,u){super(),this.documentAuditTrailService=n,this.categoryService=r,this.commonService=u,this.documentAuditTrails=[],this.displayedColumns=["createdDate","documentName","categoryName","operationName","createdBy","permissionUser","permissionRole"],this.isLoadingResults=!0,this.categories=[],this.allCategories=[],this.users=[],this.documentResource=new c.J,this.documentResource.pageSize=10,this.documentResource.orderBy="createdDate desc"}ngOnInit(){this.dataSource=new O(this.documentAuditTrailService),this.dataSource.loadDocumentAuditTrails(this.documentResource),this.getCategories(),this.getResourceParameter(),this.getUsers()}ngAfterViewInit(){this.sort.sortChange.subscribe(()=>this.paginator.pageIndex=0),this.sub$.sink=(0,h.T)(this.sort.sortChange,this.paginator.page).pipe((0,S.b)(n=>{this.documentResource.skip=this.paginator.pageIndex*this.paginator.pageSize,this.documentResource.pageSize=this.paginator.pageSize,this.documentResource.orderBy=this.sort.active+" "+this.sort.direction,this.dataSource.loadDocumentAuditTrails(this.documentResource)})).subscribe(),this.sub$.sink=(0,D.R)(this.input.nativeElement,"keyup").pipe((0,o.b)(1e3),(0,s.x)(),(0,S.b)(()=>{this.paginator.pageIndex=0,this.documentResource.skip=0,this.documentResource.name=this.input.nativeElement.value,this.dataSource.loadDocumentAuditTrails(this.documentResource)})).subscribe()}onCategoryChange(n){this.documentResource.categoryId=n.value?n.value:"",this.documentResource.skip=0,this.paginator.pageIndex=0,this.dataSource.loadDocumentAuditTrails(this.documentResource)}onUserChange(n){this.documentResource.createdBy=n.value?n.value:"",this.documentResource.skip=0,this.paginator.pageIndex=0,this.dataSource.loadDocumentAuditTrails(this.documentResource)}getCategories(){this.categoryService.getAllCategoriesForDropDown().subscribe(n=>{this.categories=n,this.setDeafLevel()})}setDeafLevel(n,r){const u=this.categories.filter(p=>p.parentId==r);return u.length>0&&u.map((p,pt)=>{p.deafLevel=n?n.deafLevel+1:0,p.index=(n?n.index:0)+pt*Math.pow(.1,p.deafLevel),this.allCategories.push(p),this.setDeafLevel(p,p.id)}),n}getUsers(){this.sub$.sink=this.commonService.getUsers().subscribe(n=>{this.users=n},n=>{n.messages.forEach(()=>{})})}getResourceParameter(){this.sub$.sink=this.dataSource.responseHeaderSubject$.subscribe(n=>{n&&(this.documentResource.pageSize=n.pageSize,this.documentResource.skip=n.skip,this.documentResource.totalCount=n.totalCount)})}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(M),t.Y36(j.H),t.Y36(B.v))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-document-audit-trail"]],viewQuery:function(n,r){if(1&n&&(t.Gf(d.NW,5),t.Gf(C.YE,5),t.Gf(Y,5)),2&n){let u;t.iGM(u=t.CRH())&&(r.paginator=u.first),t.iGM(u=t.CRH())&&(r.sort=u.first),t.iGM(u=t.CRH())&&(r.input=u.first)}},features:[t.qOj],decls:55,vars:31,consts:[[1,"row","mb-3","align-items-center","justify-content-between"],[1,"col-md-auto","col-sm-auto"],[1,"section-title"],[1,"mat-elevation-z8"],["class","loading-shade",4,"ngIf"],[1,"table-container"],[1,"row","m-2"],[1,"col-sm-4"],[1,"form-control",3,"placeholder"],["input",""],[1,"form-control",3,"placeholder","selectionChange"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],["mat-table","","matSort","","matSortActive","createdDate","matSortDirection","desc",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","documentName"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","categoryName"],["matColumnDef","createdDate"],["matColumnDef","operationName"],["matColumnDef","createdBy"],["matColumnDef","permissionUser"],["matColumnDef","permissionRole"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],[4,"matNoDataRow"],[3,"length","pageSize","pageSizeOptions"],[1,"loading-shade"],[1,"country-item",3,"ngStyle"],[4,"ngIf"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-row",""],["mat-row",""],[1,"pt-2","pl-3"]],template:function(n,r){1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2"),t._uU(4),t.ALo(5,"translate"),t.qZA()()()(),t.TgZ(6,"div",3),t.YNc(7,$,2,0,"div",4),t.ALo(8,"async"),t.TgZ(9,"div",5)(10,"div",6)(11,"div",7),t._UZ(12,"input",8,9),t.ALo(14,"translate"),t.qZA(),t.TgZ(15,"div",7)(16,"mat-select",10),t.NdJ("selectionChange",function(p){return r.onCategoryChange(p)}),t.ALo(17,"translate"),t.TgZ(18,"mat-option",11),t._uU(19),t.ALo(20,"translate"),t.qZA(),t.YNc(21,F,4,6,"mat-option",12),t.qZA()(),t.TgZ(22,"div",7)(23,"mat-select",10),t.NdJ("selectionChange",function(p){return r.onUserChange(p)}),t.ALo(24,"translate"),t.TgZ(25,"mat-option",11),t._uU(26),t.ALo(27,"translate"),t.qZA(),t.YNc(28,z,2,3,"mat-option",12),t.qZA()()(),t.TgZ(29,"table",13),t.ynx(30,14),t.YNc(31,J,3,3,"th",15),t.YNc(32,P,2,1,"td",16),t.BQk(),t.ynx(33,17),t.YNc(34,K,3,3,"th",15),t.YNc(35,W,2,1,"td",16),t.BQk(),t.ynx(36,18),t.YNc(37,w,4,6,"th",15),t.YNc(38,G,3,4,"td",16),t.BQk(),t.ynx(39,19),t.YNc(40,X,3,3,"th",15),t.YNc(41,V,3,3,"td",16),t.BQk(),t.ynx(42,20),t.YNc(43,k,3,3,"th",15),t.YNc(44,q,2,1,"td",16),t.BQk(),t.ynx(45,21),t.YNc(46,tt,3,3,"th",15),t.YNc(47,et,2,1,"td",16),t.BQk(),t.ynx(48,22),t.YNc(49,nt,3,3,"th",15),t.YNc(50,ot,2,1,"td",16),t.BQk(),t.YNc(51,it,1,0,"tr",23),t.YNc(52,at,1,0,"tr",24),t.YNc(53,rt,6,3,"tr",25),t.qZA(),t._UZ(54,"mat-paginator",26),t.qZA()()),2&n&&(t.xp6(4),t.Oqu(t.lcZ(5,16,"DOCUMENTS_AUDIT_TRAIL")),t.xp6(3),t.Q6J("ngIf",t.lcZ(8,18,r.dataSource.loading$)),t.xp6(5),t.s9C("placeholder",t.lcZ(14,20,"SEARCH_DOCUMENT_BY_NAME")),t.xp6(4),t.s9C("placeholder",t.lcZ(17,22,"SELECT_CATEGORY")),t.xp6(3),t.hij("-- ",t.lcZ(20,24,"NONE")," --"),t.xp6(2),t.Q6J("ngForOf",r.allCategories),t.xp6(2),t.s9C("placeholder",t.lcZ(24,26,"SELECT_USER")),t.xp6(3),t.hij("-- ",t.lcZ(27,28,"NONE")," --"),t.xp6(2),t.Q6J("ngForOf",r.users),t.xp6(1),t.Q6J("dataSource",r.dataSource),t.xp6(22),t.Q6J("matHeaderRowDef",r.displayedColumns)("matHeaderRowDefSticky",!0),t.xp6(1),t.Q6J("matRowDefColumns",r.displayedColumns),t.xp6(2),t.Q6J("length",r.documentResource.totalCount)("pageSize",r.documentResource.pageSize)("pageSizeOptions",t.DdM(30,st)))},dependencies:[l.sg,l.O5,l.PC,m.BZ,m.fO,m.as,m.w1,m.Dz,m.nj,m.ge,m.ev,m.XQ,m.Gk,m.Ee,R.Ou,x.gD,I.ey,C.YE,C.nU,d.NW,l.Ov,l.uU,U.X$]}),e})(),data:{claimType:"document_audit_trail_view_document_audit_trail"},canActivate:[A.a]}];let ut=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[f.Bz.forChild(ct),f.Bz]}),e})();var lt=i(2368),dt=i(7531);let mt=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[l.ez,ut,m.p0,R.Cq,x.LD,lt.rP,C.JX,d.TU,dt.c,U.aw]}),e})()}}]);